\section{Levy's First-Order Reflection}\label{sec:first_order}

\subsection{Lévy's Original Paper}\label{sec:levy1960}
This section is based on Lévy's paper \emph{Axiom Schemata of Strong Infinity in Axiomatic Set Theory}, \cite{Levy60a}. It presents Lévy's general reflection principle and its equivalence to \emph{Replacement} and \emph{Infinity} under $\sf{S}$\footnote{See definition (\ref{def:s}).}.

First, we should point out that set theory has changed over the last 66 years and show a few notable, albeit only formal, differences.
%When reading Lévy's article, one should bear in mind that while the author often speaks about a~model of $\sf{ZF}$, usually denoted $u$, it doesn't necessarily mean that there is a set $u$ that is a model of $\sf{ZF}$\footnote{This is indeed impossible to prove in $\sf{ZF}$ due to Gödel's Incompleteness.}, we are nowadays used to using the notion of universal class $V$ in similar sense, even though independently from a particular axiomatic set theory. %We will review the exact meaning of the notion of a standard complete model in a moment.
%The theory $\sf{ZF}$ is practically identical to the theory we have established in (\ref{def:zf}), the differences are only formal.
One might be confused by the fact that Lévy treats the \emph{Subsets} axiom, which we call \emph{Specification}, as a single axiom rather than a schema. He even takes the conjunction of all axioms of $\sf{ZF}$ and treats it like a formula. This is possible because the underlying logic calculus is different. Lévy works with set theories formulated in the \emph{non-simple applied first order functional calculus}, see beginning of \emph{Chapter IV} in \cite{church1996introduction} for details. For now, we only need to know that the calculus contains a substitution rule for functional variables. This way, \emph{Subsets} is de facto a schema even though it sometimes treated as a single formula\footnote{This way, the conjunction of all axioms is then in fact an axiom schema.} but the logic is still first-order since one can't quantify over functional variables. We will use the usual first-order axiomatization of \sf{ZFC} as seen on \cite{JechBook}.
% todo koukni do churche jak se to s tim ma, p.219
It should also be noted that the logical connectives look different. The now usual symbol for an universal quantifier does not appear, $\forall x \varphi (x)$ would be written as $(x) \varphi (x)$. The symbol for negation is ``$\sim$'', implication is written as ``$\supset$'' and equivalence is ``$\equiv$''. We will use standard notation with ``$\neg$'', ``$\then$'' and ``$\iff$'' respectively when presenting Lévy's results.

%The following definitions are not used in contemporary set theory, but they illustrate 1960's set theory mind-set and they are used heavily in Lévy's text, so we will include and explain them for clarity. 
%Generally in this chapter, $\sf{Q}$ stands for an arbitrary axiomatic set theory. % used for general definitions, $u$ is usually a model of $\sf{Q}$, counterpart of today's the universal class $V$.

\

This subsection uses $\sf{ZF}$ instead of the usual $\sf{ZFC}$ as the underlying theory. % neni to zbytecny?

\begin{definition}{(Standard Complete Model of a Set Theory)}\label{def:scm_q}\\
Let $\sf{Q}$ be an arbitrary axiomatic set theory.
We say that $u$ is a standard complete model of $\sf{Q}$ iff
\bce[(i)]
\item $(\forall \sigma \in \sf{Q})(\langle u, \in \rangle \models \sigma)$
\item $\forall y (y \in u \then y \subset u)$ ($u$ is transitive)
% \item $\forall e \langle x, y \rangle \in e \iff (y \in u \et x \in y)$ % co je $e$? omg je to jinak, je to model vsech axiomu pro vsechny $e$!!! relatiizace do u, e?
\ece 
We write $Scm^{\sf{Q}}(u)$.
\end{definition}

\begin{definition}{(Cardinals Inaccessible With Respect to $\sf{Q}$)}\label{def:levy_inaccessible_q}\\
Let $\sf{Q}$ be an arbitrary axiomatic set theory. We say that a cardinal $\kappa$ is inaccessible with respect to theory $\sf{Q}$ iff
\begin{equation}
Scm^{\sf{Q}}(V_\kappa)
\end{equation}
We write $In^{\sf{Q}}(\kappa)$.\footnote{To be able to define $V_\kappa$, we need to work in a logic that contains the \emph{Replacement Schema} or any of it's equivalents. It should be noted that we don't work in an arbitrary theory \sf{Q}, but in \sf{ZF}, which contains the \emph{Replacement Schema}. $Scm^{\sf{Q}}(V_\kappa)$ in fact says ``\sf{ZF} thinks that $V_\kappa$ is a transitive model of \sf{Q}''.}
\end{definition}

\begin{definition}{(Inaccessible Cardinal With Respect to $\sf{ZF}$)}\label{def:levy_inaccessible}\\
When a cardinal $\kappa$ is inaccessible with respect to $\sf{ZF}$, we only say that it is inaccessible. We write $In(\kappa)$.
\begin{equation}
In(\kappa) \iff In^{\sf{ZF}}(\kappa)
\end{equation}
\end{definition}
The above definition of inaccessibles is used because it doesn't require \emph{Choice}.

For the definition of relativization, see (\ref{def:relativization}). The notation used by Lévy is ``$Rel(u, \varphi)$'', we will stick to ``$\varphi^{u}$''.
\begin{definition}{($N$)}\label{def:levy_axiom_n}\\
The following is an axiom schema of complete reflection over $\sf{ZF}$, denoted $N$. For every first-order formula $\varphi$ in the language of set theory with no free variables except for $p_1, \ldots , p_n$, the following is an instance of schema $N$.
\begin{equation}
\exists u (Scm^{\sf{ZF}}(u) \et (\forall p_1, \ldots, p_n \in u)(\varphi \iff \varphi^{u}))
\end{equation}
%where $\varphi$ is a~formula which contains no free variables except for $p_1, \ldots , p_n$.
\end{definition}

\begin{definition}{(N')}\label{def:levy_axiom_n'}\\
For any first-order formulas $\varphi_1, \ldots, \varphi_m$ in the language of set theory with no free variables except for $p_1, \ldots , p_n$, the following is an instance of schema $N'$.
\begin{equation}
\exists u (z \in u \et Scm^{\sf{ZF}}(u) \et (\forall p_1, \ldots, p_n \in u)(\varphi_1 \iff \varphi_1^{u}) \et \ldots \et \varphi_m \iff \varphi_m^{u}))
\end{equation}
\end{definition}

\begin{definition}{(N')}\label{def:levy_axiom_n'}\\
For any first-order formulas $\varphi_1, \ldots, \varphi_m$ in the language of set theory with no free variables except for $p_1, \ldots , p_n$, the following is an instance of schema $N'$.
\begin{equation}
\exists u (Scm^{\sf{ZF}}(u) \et (\forall p_1, \ldots, p_n \in u)(\varphi_1 \iff \varphi_1^{u}) \et \ldots \et \varphi_m \iff \varphi_m^{u}))
\end{equation}
\end{definition}

Let $\sf{S}$ be an axiomatic set theory defined in (\ref{def:s}). 

This is \emph{Theorem 2} in \cite{Levy1960a}
\begin{lemma}{($N \iff N'' \iff N'$)}\label{lemma:n_iff_n'}\\
The schemas $N$, $N'$ and $N''$ are equivalent under \sf{S}.
\end{lemma}

\begin{proof}
We will execute this proof in the theory \sf{ZF}, but the reader should note that we are neither using \emph{Replacement} nor \emph{Infinity}, 
so for schemas similar to $N$, $N'$, $N''$ but with ``$Scm^{\sf{S}}(u)$'' instead of ``$Scm^{\sf{ZF}}(u)$'', the proof works equally well.

Clearly, $N' \then N'' \then N$. 

Now, assuming $N$ and given the formulas $\varphi_1, \ldots, \varphi_n$, we will prove $N''$. Consider the following formula:
\beq
\psi = \bigvee\limits_{i=1}^t t = i \et \varphi_i
\eeq
We will take advantage of the fact that natural numbers are defined by atomic formulas and therefore absolute in transitive structures. 
From $N$, we get such $u$ that $Scm^{\sf{ZF}}(u) \et (\forall p_1, \ldots, p_n \in u)(\bigvee\limits_{i=1}^t t = i \et \varphi_i \iff \bigvee\limits_{i=1}^t t = i \et \varphi_i^{u})$.
This already satisfies $N''$.

In order to prove $N'$ from $N''$, let's add two more formulas. Given $p_1, \ldots, p_n$, we denote
\beq
\varphi_{m+1} = \exists u (z \in u \et Scm^{\sf{ZF}}(u) \et (\forall p_1, \ldots, p_n \in u)(\bigvee\limits_{i=1}^m \varphi_i = \varphi_i^u))
\eeq
\beq
\varphi_{m+2}  = \forall z \varphi_{m+1}
\eeq
So, by $N''$, we have a set $u$ that satisfies $Scm^{\sf{ZF}}(u)$ as well as the following:
\beq
(\forall p_1, \ldots, p_n \in u)(\varphi_i \iff \varphi_i^u) \mbox{ for }1 \leq i \leq m \label{eq:levy_th_2_eq_3}
\eeq
\beq
z \in u \then \varphi_{m+1} \iff \varphi_{m+1}^u\label{eq:levy_th_2_eq_4}
\eeq
\beq
\varphi_{m+2} \iff \varphi_{m+2}^u\label{eq:levy_th_2_eq_5}
\eeq
By $Scm^{\sf{ZF}}(u)$ and (\ref{eq:levy_th_2_eq_3}), we get $(\forall z \in u) \varphi_{m+1}$, % watt? nemel bych reflektovat i $\varphi_{m+1}$ v eq:levy_th_2_eq_3 ?
so together with (\ref{eq:levy_th_2_eq_4}), we get $(\forall z \in u) \varphi_{m+1}^u$, exactly $\varphi_{m+2}^u$, so by (\ref{eq:levy_th_2_eq_5}) we get $\varphi_{m+2}$. 
But $\varphi_{m+2}$ is exactly the instance of $N'$ we were looking for.
\end{proof}

\begin{definition}{($N_0$)}\label{def:levy_axiom_n0}\\
Axiom schema $N_0$ is similar to $N$ defined above, but with $\sf{S}$ instead of $\sf{ZF}$. For every $\varphi$, a first-order fomula in the language of set theory with no free variables except $p_1, \ldots , p_n$, the following is an instance of $N_0$.
\begin{equation}
\exists u (Scm^{\sf{S}}(u) \et (\forall p_1, \ldots , p_n \in u)(\varphi \iff \varphi^{u}))
\end{equation}
%where $\varphi$ is a~formula which contains no free variables except for $p_1, \ldots , p_n$.
\end{definition}

We will now show that in $\sf{S}$, $N_0$ implies both \emph{Replacement} and \emph{Infinity}.

\

Let $N_0$ be defined as in (\ref{def:levy_axiom_n0}), for \emph{Infinity} see (\ref{def:infinity}).
\begin{theorem}\label{theorem:n0_implies_infinity}\
In $\sf{S}$, the axiom schema $N_0$ implies \emph{Infinity}.
\end{theorem}

\begin{proof} % Levy to bere pres V_\lambda \models 
Let $\varphi = \forall x \exists y (y = x \cup \{x\})$. 
This clearly holds in $\sf{S}$ because given a set $x$, there is a set $y = x \cup \{x\}$ obtained via \emph{Pairing} and \emph{Union}. %\emph{Powerset} and \emph{Specification}.
From $N_0$, there is a set $u$ such that $\varphi^{u}$ holds. % TODO upresnit
 This $u$ satisfies the conditions required by \emph{Infinity}.
\end{proof}

Lévy proves this theorem in a different way. He argues that for an arbitrary formula $\varphi$, $N_0$ gives us $\exists u Scm^{\sf{S}}(u)$ and this $u$ already satisfies \emph{Infinity}. 
To do this, we would need to prove lemma (\ref{lemma:scm_s_is_limit}) earlier on, we will do that later in this chapter.
%We would need to prove (\ref{lemma:scm_s_is_limit}), which will happen later in this chapter, but we don't know that yet. % mozna taky trochu preformulovat

\

Let $\sf{S}$ be a set theory defined in (\ref{def:s}), $N_0$ a schema defined in (\ref{def:levy_axiom_n0}) and \emph{Replacement} a schema defined in (\ref{def:replacement}).
\begin{theorem} 
%In $\sf{S}$ with $N_0$ implies \emph{Replacement}.\\
%TODO jedno nebo druhe % nebo treti
In $\sf{S}$, the axiom schema $N_0$ implies \emph{Replacement}.
%\beq
%\sf{S}, N_0 \vdash \mbox{\emph{Replacement}}
%\sf{S} \vdash N_0 \then \mbox{\emph{Replacement}}
%\eeq % nebo S \vdash N_0 \then Replacement % (veta o dedukci?) nebo \sf{S} + N_0 \vdash Repl
\end{theorem}
% todo zkontrolovat ========================================================================================== % TODO asi cely blbe? ...
\begin{proof}
Let $\varphi(x, y, p_1, \ldots, p_n)$ be a~formula with no free variables except $x, y, p_1, \ldots, p_n$.
%Out goal is to prove
%\beq
%``\varphi\mbox{ is a function}''\then \forall x \exists y \forall z (z \in y \iff (\exists q \in x)(\varphi(x, y, p_1, \ldots, p_n)))
%\eeq
Let a set $x$ be given and let $\chi$ be an instance of the \emph{Replacement} schema for the $\varphi$ given.
We want to verify in $\sf{S}$ that given a formula $\varphi$, the instance of $N_0$ for $\varphi$ implies $\chi$.
\begin{equation}
\begin{gathered}
\chi = \forall x', y', z(\varphi(x', y', p_1, \ldots, p_n) \et \varphi(x', z, p_1, \ldots, p_n) \then y' = z') \\
\then \exists y \forall z (z \in y \iff (\exists q \in x)(\varphi(x, y, p_1, \ldots, p_n)))
\end{gathered}
\end{equation}

Since it can be shown that $N_0$ is equivalent to $N'_0$ similar to $N'$ in lemma (\ref{lemma:n_iff_n'}), 
there is a set $u$ such that $Scm^{\sf{S}}(u)$, $x \in u$ and all of the following hold:
\bce[(i)]
\item $\varphi \iff \varphi^{u}$
\item $\exists y \varphi \iff (\exists y \varphi)^{u}$
\item $\chi \iff \chi^{u}$
% \item $\forall x, p_1, \ldots, p_n \chi \iff (\forall x, p_1, \ldots, p_n \chi)^{u}$.
\ece
%The above formulas are instances of the $N_0$ schema for $\varphi$, $\exists y \varphi$, $\chi$ and the universal closure of $\chi$ respectively.
%By $N_0$, there exists a set $u$ where all four formulas hold.\footnote{Despite the fact that $N_0$ is defined for one formula, we have just used it for four at once. To make this formally possible, we can either prove that $N_0$ is equivalent to a more general version for any finite number of formulas or we can reflect their conjunction and argue that if $\langle u, \in \rangle \models \varphi_1 \et \ldots \et \varphi_n$, then $(\langle u, \in \rangle \models \varphi_1), \ldots, (\langle u, \in \rangle \models \varphi_n)$.}
From relativization, $(\exists y \varphi)^{u}$ is equivalent to $(\exists y \in u) \varphi^{u}$, together with (i) and (ii), we get
\begin{equation}
(\exists y \in u)\varphi \iff \exists y \varphi
\end{equation}

If $\varphi$ is a~function, %then for every $x \in u$, which is also $x \subset u$ since $u$ is transitive from $Scm^{\sf{S}}(u)$,
it maps the elements of $x$, which are also elements of $u$ due to transitivity of $u$, to elements $u$. From \emph{Specification}, we can find $y$, a~set of all images of the elements of $x$ via $\varphi$. That means the following is an instance of \emph{Replacement} for $\varphi$ and $x$ and it holds in $u$, so we get $\chi^{u}$, which means that $\chi$ holds by (iii).
% \beq
% (\forall p_1, \ldots, p_n \in u) \chi\mbox{.}
% \eeq
% By (iii) this is equivalent to 
% \beq
% (\forall p_1, \ldots, p_n \in u) \chi^{u}\mbox{.}
% \eeq 
% which is exactly 
% \beq
% (\forall p_1, \ldots, p_n \chi)^{u}\mbox{.}
% \eeq
% From (iv), $\forall x, p_1, \ldots, p_n \chi$ holds. 
\end{proof} %  POZOR na X!

% ======================================================= % zkontrolovano sem!
What we have just proven is only a single theorem from Lévy's aforementioned article, we will introduce other interesting results, dealing with inaccessible and Mahlo cardinals, later in their appropriate context in chapter 3. % porad trochu kostrbaty?

% =====================================================================================================================================

\subsection{Contemporary Restatement}
We will now introduce and prove a theorem that is called Lévy's Reflection in contemporary set theory. The only difference is that while Lévy originally reflects a formula $\varphi$ from $V$ to a set $u$ which is a \emph{standard complete model of $\sf{S}$}, we say that there is a $V_\lambda$ for a limit $\lambda$ that reflects $\varphi$. Those two conditions are equivalent due to lemma (\ref{lemma:scm_s_is_limit}).

%\begin{definition}{(Reflection\textsubscript{1})}\label{def:reflection_1}\\ % co spis Levy's reflection principle?
%Let $\varphi(p_1, \ldots, p_n)$ be a first-order formula in the language of set theory. Than the following holds for any such $\varphi$.
%\begin{equation}
%\forall M_0 \exists M (M_0 \subseteq M \et (\varphi^M(p_1, \ldots, p_n) \iff \varphi(p_1, \ldots, p_n)))
%\end{equation}
%\end{definition}

% Note that this is a restatement of both Lévy's $N$ and $N_0$ from the previous chapter\footnote{see (\ref{def:levy_axiom_n}) and (\ref{def:levy_axiom_n0}}). We prefer to call it \emph{First-order reflection} so it complies with how other axioms and schemata are named. \footnote{We will not use the name $N_0$, because it might be confusing to work $N_0$ and $M_0$ where $M_0$ is a set and $N_0$ is an axiom schema.} 
% Note that the subscript 1 refers to the fact that $\varphi(p_1, \ldots, p_n)$ is a first-order formula, and since we're using the word ``reflection'' in less strict meaning throughout this thesis, distinguishing between the two just by using italic font face for the schema might cause confusion.

% We will now prove the equivalence of \emph{First-order reflection} with \emph{Replacement} and \emph{Infinity} in $\sf{S}$ in two parts. First, we will show that \emph{First-order reflection} is a theorem of $\sf{ZFC}$, then we shall show that the second implication, which proves \emph{Infinity} and \emph{Replacement} from \emph{First-order reflection}, also holds.

% The following lemma is usually done in two parts, the first being for one formula, the other for $n$ formulas. We will only state and prove the more general version.

\begin{lemma}\label{lemma:reflection_lemma}\
Let $\varphi_1, \ldots, \varphi_n$ be first-order formulas in the language of set theory, all with $m$ free variables
\footnote{For formulas with a different number of free variables, take for $m$ the highest number of parameters among those formulas. Add spare parameters to every formula that has less than $m$ parameters in a way that preserves the last parameter, which we will denote $x$.
E.g. let $\varphi'_i$ be the a~formula with $k$ parameters, $k < m$. Let us set $\varphi_i(p_1, \ldots, p_{m-1}, x) = \varphi'_i(p_1, \ldots, p_{k-1}, x)$, notice that the parameters $p_k, \ldots, p_{m-1}$ are not used.}.
\bce[(i)]
\item For each set $M_0$ there is such set $M$ that $M_0 \subset M$ and the following holds for every $i$, $1 \leq i \leq n$:
\begin{equation}\label{equation:refl_lemma_i}
\exists x \varphi_i(p_1, \ldots, p_{m-1}, x) \then (\exists x \in M) \varphi_i(p_1, \ldots, p_{m-1}, x)
\end{equation}
for every $p_1, \ldots, p_{m-1} \in M$.

\item Furthermore, there is a limit ordinal $\lambda$ such that $M_0 \subset V_\lambda$ and the following holds for each $i$, $1 \leq i \leq n$:
\begin{equation}\label{equation:refl_lemma_ii}
\exists x \varphi_i(p_1, \ldots, p_{m-1}, x) \then (\exists x \in V_\lambda) \varphi_i(p_1, \ldots, p_{m-1}, x)
\end{equation}
for every $p_1, \ldots, p_{m-1} \in M$.

\item Assuming \emph{Choice}, there is $M$, $M_0 \subset M$ such that (\ref{equation:refl_lemma_i}) holds for every $M,\ i \leq n$ and $|M| \leq |M_0| \cdot \aleph_0$.
\ece
\end{lemma}

\begin{proof}
We will simultaneously prove statements (i) and (ii), denoting $M^T$ the transitive set required by part (ii).
Steps in the construction of $M^T$ that are not explicitly included are equivalent to steps for $M$.

Let us first define an operation $H_i(p_1, \ldots, p_{m-1})$ that yields the set of $x$'s with minimal rank\footnote{Rank is defined in (\ref{def:rank})} satisfying $\varphi_i(p_1, \ldots, p_{m-1}, x)$ for $p_1, \ldots, p_{m-1}$ and for every $i$, $1 \leq i \leq n$.

\begin{equation}
H_i(p_1, \ldots, p_n) = \{x \in C_i: (\forall z \in C)(rank(x) \leq rank(z))\}
\end{equation}
for each $1 \leq i \leq n$, where
\begin{equation}
C_i = \{x: \varphi_i(p_1, \ldots, p_{m-1}, x)\} \mbox{ for $1 \leq i \leq n$}
\end{equation}

\

Next, let's construct $M$ from given $M_0$ by induction. 
\begin{equation}
M_{i+1} = M_i \cup \bigcup_{j=0}^{n} \bigcup \{H_j(p_1, \ldots, p_{m-1}): p_1, \ldots, p_{m-1} \in M_i\}
\end{equation}
In other words, in each step we include into the construction the elements satisfying $\varphi(p_1, \ldots, p_{m-1}, x)$ for $p_1, \ldots, p_{m-1}$ from the previous step.
For statement (ii), this is the only part that differs from (i). To end up with a transitive $M$, we need to extend every step to it's transitive closure transitive closure of $M_{i+1}$ from (i). In other words, let $\gamma$ be the smallest ordinal such that 
\begin{equation}
(M^T_i \cup \bigcup_{j=0}^{n} \{\bigcup\{H_j(p_1, \ldots, p_{m-1}): p_1, \ldots, p_{m-1} \in M_i\}\}) \subset V_\gamma
\end{equation}
Then the incremental step is
\begin{equation}
M^T_{i+1} = V_\gamma
\end{equation}
and the final $M$ is obtained by joining the previous steps.
\begin{equation}
M = \bigcup_{i=0}^{\infty} M_i, \mbox{  }M^T = \bigcup_{i=0}^{\infty} M^T_i = V_\lambda\mbox{ for some limit }\lambda\mbox{.}
\end{equation}

\

We have yet to finish part (iii).
Let's try to construct a~set $M'$ that satisfies the same conditions like $M$ but is kept as small as possible. Assuming the Axiom of Choice, we can modify the construction so that the cardinality of $M'$ is at most $|M_0| \cdot \aleph_0$. Note that the size of $M$ in the previous construction is determined by the size of $M_0$ and, most importantly, by the size of $H_i(p_1, \ldots, p_{m-1})$ for every $i$, $1 \leq i \leq n$ in individual iterations of the construction. Since (i) only ensures the existence of an $x$ that satisfies $\varphi_i(p_1, \ldots, p_{m-1}, x)$ for any $i$, $1 \leq i \leq n$, we only need to add one $x$ for every set of parameters but $H_i(u_1, \dots, u_{m-1})$ can be arbitrarily large. Let $F$ be a~choice function on $\power{M'}$. Also let $h_i(p_1, \ldots, p_{m-1}) = F(H_i(p_1, \ldots, p_{m-1}))$ for $i$, where $1 \leq i \leq n$, which means that $h$ is a~function that outputs an $x$ that satisfies $\varphi_i(p_1, \ldots, p_{m-1}, x)$ for $i$ such that $1 \leq i \leq n$ and has minimal rank among all such sets. The induction step needs to be redefined to
\begin{equation}
M'_{i+1} = M'_i \cup \bigcup_{j=0}^n \{ h_j(p_1, \ldots, p_{m-1}): p_1, \ldots, p_{m-1} \in M'_i \}
\end{equation}
This way, the amount of elements added to $M'_{i+1}$ in each step of the construction is the same as the amount of $m$-tuples of parameters that yielded elements not included in $M'_i$. It is easy to see that if $M_0$ is finite, $M'$ is countable because it was constructed as a countable union of sets that are themselves at most countable. If $M_0$ is countable or larger, the cardinality of $M'$ is equal to the cardinality of $M_0$.\footnote{It can not be smaller because $|M'_{i+1}| \geq |M'_i|$ for every $i$. It may not be significantly larger because the maximum of elements added is the number of $n$-tuples in $M'_i$, which is of the same cardinality as $M'_i$.}
Therefore $|M'| \leq |M_0| \cdot \aleph_0$
\end{proof}

\begin{theorem}{(Lévy's first-order reflection theorem)}\label{theorem:first_order_reflection}\\
Let $\varphi(p_1, \ldots, p_n)$ be a~first-order formula.
\bce[(i)]
\item For every set $M_0$ there exists a set $M$ such that $M_0 \subset M$ and the following holds:
\begin{equation}
\varphi^M(p_1, \ldots, p_n) \iff \varphi(p_1, \ldots, p_n)\label{equation:levy_theorem_i}
\end{equation}
for every $p_1, \ldots, p_n \in M$.

\item For every set $M_0$ there is a~transitive set $M$, $M_0 \subset M$ such that the following holds:
\begin{equation}
\varphi^M(p_1, \ldots, p_n) \iff \varphi(p_1, \ldots, p_n)
\end{equation}
for every $p_1, \ldots, p_n \in M$.

\item For every set $M_0$ there is a limit ordinal $\lambda$ such that $M_0 \subset V_{\lambda}$ and the following holds:
\begin{equation}
\varphi^{V_{\lambda}}(p_1, \ldots, p_n) \iff \varphi(p_1, \ldots, p_n)
\end{equation}
for every $p_1, \ldots, p_n \in M$.

\item Assuming \emph{Choice}, for every set $M_0$ there is $M$ such that $M_0 \subset M$ and $|M| \leq |M_0| \cdot \aleph_0$ and the following holds:
\begin{equation}
\varphi^M(p_1, \ldots, p_n) \iff \varphi(p_1, \ldots, p_n)
\end{equation}
for every $p_1, \ldots, p_n \in M$.
\ece
\end{theorem}

\begin{proof}
% CO ty parametry? \varphi(p_1, \ldots, p_n) nebo jen \varphi ?
%Before we start, note that the following holds for any set $M$ if $\varphi$ is an atomic formula(x1 \in x2 or x1 = x2), as a direct consequence of relativisation to $M, \in$\footnote{See (\ref{def:relativization}). Also note that this only holds for relativization to $M, \in$, not $M, E$ for arbitrary $E$.}. 
%\begin{equation}
%\varphi \iff \varphi^M
%\end{equation}
Let's now prove (i) for given $\varphi$ via induction by complexity. We can safely assume that $\varphi$ contains no quantifiers besides ``$\exists$'' and no logical connectives other than ``$\neg$'' and ``$\et$''.
Let $\varphi_1, \ldots, \varphi_n$ be all subformulas of $\varphi$. Then there is a set $M$, obtained by the means of lemma (\ref{lemma:reflection_lemma}), for all of the formulas $\varphi_1, \ldots, \varphi_n$. 

Let's first consider atomic formulas in the form of either $x_1 = x_2$ or $x_1 \in x_2$. % preformulovat trochu
It is clear from relativisation\footnote{See (\ref{def:relativization}). This only holds for relativization to $M, \in \cap M \times M$, not $M, R$ for an arbitrary $R$.} that (\ref{equation:levy_theorem_i}) holds for both cases, $(x_1 = x_2)^M \iff (x_1 = x_2)$ and $(x_1 \in x_2)^M \iff (x_1 \in x_2)$.

\

We now want to verify the inductive step. First, take $\varphi = \neg \varphi'$. From relativization, we get $(\neg \varphi')^M \iff \neg (\varphi'^M)$.
Because the induction hypothesis tells us that $\varphi'^M \iff \varphi'$, the following holds:
\begin{equation}
(\neg \varphi')^{M} \iff \neg (\varphi'^M) \iff \neg \varphi'
\end{equation}

The same holds for $\varphi = \varphi_1 \et \varphi_2$. From the induction hypothesis, we know that $\varphi_1^M \iff \varphi_1$ and $\varphi_2^M \iff \varphi_2$, which together with relativization for formulas in the form of $\varphi_1 \et \varphi_2$ gives us
\begin{equation}
(\varphi_1 \et \varphi_2)^M \iff \varphi_1^M \et \varphi_2^M \iff \varphi_1 \et \varphi_2
\end{equation}

\
% kde jsem tu najednou vzal parametry? TODO
Let's now examine the case when $\varphi = \exists x \varphi'(p_1, \ldots, p_n, x)$. The induction hypothesis tells us that $\varphi'^M(p_1, \ldots, p_n, x) \iff \varphi'(p_1, \ldots, p_n, x)$,
so, together with above lemma (\ref{lemma:reflection_lemma}), the following holds:
\begin{equation}
\begin{gathered}
\varphi(p_1, \ldots, p_n, x) \\
\iff \exists x \varphi'(p_1, \ldots, p_n, x) \\
\iff (\exists x \in M) \varphi'(p_1, \ldots, p_n, x) \\
\iff (\exists x \in M) \varphi'^M (p_1, \ldots, p_n, x) \\
\iff (\exists x \varphi'(p_1, \ldots, p_n, x))^M \\
\iff \varphi^M(p_1, \ldots, p_n, x)
\end{gathered}
\end{equation}
Which is what we wanted to prove for part (i). %\ref{equation:levy_theorem_i} holds for all subformulas $\varphi_1, \ldots, \varphi_n$ of a given formula $\varphi$.

\

%So far we have proven part $\bold{(i)}$ of this theorem for one formula $\varphi$. 
We now need to verify that the same holds for any finite number of formulas $\varphi_1, \ldots, \varphi_n$. 
This has in fact been already done since lemma (\ref{lemma:reflection_lemma}) gives us a set $M$ for any finite amount of formulas and given $M_0$. We can therefore find a set $M$ for the union of all of their subformulas. When we obtain such $M$, it should be clear that it also reflects every formula in $\varphi_1, \ldots, \varphi_n$.

\

Since $V_\lambda$ is a~transitive set, by proving $\bold{(iii)}$ we also satisfy $\bold{(ii)}$. To do so, we only need to look at part $\bold{(ii)}$ of lemma (\ref{lemma:reflection_lemma}). All of the above proof also holds for $M = V_lambda$. 

To finish part $\bold{(iv)}$, we take $M$ of size $\leq |M_0| \cdot \aleph_0$, which exists due to part $\bold{(iii)}$ of lemma (\ref{lemma:reflection_lemma}), the rest being identical.
\end{proof}

% TODO existuje jich dokonce club set!
% viz http://ozark.hendrix.edu/~yorgey/settheory/15-reflection-principle.pdf


\

Let $\sf{S}$ be a set theory defined in (\ref{def:s}), for $\sf{ZFC}$ see definition (\ref{def:zfc}).

% ACHTUNG
% Sm je definovany jako konjunkce vsech relativizovanych axiomu, takze to je kruh...
% presunout do contemporary restatement?
% viz Levy str. (224)
% todo s/u/V_lambda
% DRAKE!!! ch.3, ch.4 dukaz v_alfa models ZFC pro limitni alfa bez nekonecna etc
% Drake dokazuje reflexi v ch.3 par.6.3

The two following lemmas are based on \cite{DrakeBook}[Chapter 3, Theorem 1.2].
\begin{lemma}\label{lemma:extensionality_in_transitive} % Drake ch.3 Theorem 1.2
If $M$ is a transitive set, then $\langle M, \in \rangle \models \mbox{\emph{Extensionality}}$.
\end{lemma}

\begin{proof}
Given a transitive set $M$, we want to show that the following holds.
\beq
\langle M, \in \rangle \models \forall x, y (x = y \iff \forall z (z \in x \iff z \in y))
\eeq % TODO pozor na definici splnovani!
% From satisfaction, we get that for every $x$, $y$, the following holds % neni v definici splnovani, ze volny musej platit vsechny?
Given arbitrary $x, y \in M$, we want to prove that $\langle M, \in \rangle \models (x = y \iff \forall z (z \in x \iff z \in y))$.
This is equivalent to % ref na definici pravdy
$\langle M, \in \rangle \models x = y \mbox{ iff } \langle M, \in \rangle \models \forall z(z \in x \iff z \in y)$, 
which is the same as $x = y \mbox{ iff } \langle M, \in \rangle \models \forall z(z \in x \iff z \in y)$.

So all elements of $x$ are also elements of $y$ in $M$, and vice versa. Because $M$ is transitive, all elements of $x$ and $y$ are in $M$, so $\langle M, \in \rangle \models \forall z(z \in x \iff z \in y)$ holds iff $x$ and $y$ contain the same elements and are therefore equal.
\end{proof}

\begin{lemma}\label{lemma:foundation_in_transitive}
If $M$ is a transitive set, then $\langle M, \in \rangle \models \mbox{\emph{Foundation}}$.
\end{lemma}

\begin{proof}
We want to prove the following:
\beq
\langle M, \in \rangle \models \forall x (x \neq \emptyset \then (\exists y \in x) (x \cap y = \emptyset))
\eeq

Given an arbitrary non-empty $x \in M$ let's show that $\langle M, \in \rangle \models (\exists y \in x) (x \cap y = \emptyset)$.

Because $M$ is transitive, every element of $x$ is an element of $M$. Take for $y$ the element of $x$ with the lowest rank\footnote{Rank is defined in (\ref{def:rank}).}. It should be clear that there is no $z \in y$ such that $z \in x$, because then $rank(z) < rank(y)$, which would be a contradiction.
\end{proof}

Let $\sf{S}$ be a set theory as defined in (\ref{def:s}). 
\begin{lemma}\label{lemma:scm_s_is_limit}\
The following holds for every $\lambda$.
\begin{equation}
\mbox{``$\lambda$ is a limit ordinal''} \then V_\lambda \models \sf{S} % proc ne?
\end{equation}
\end{lemma}

\begin{proof}
Given an arbitrary limit ordinal $\lambda$, we will verify the axioms of \sf{S} one by one.
\bce[(i)]
\item \emph{The existence of a set} comes from the fact that $V_\lambda$ is a non-empty set because limit ordinal is non-zero by definition.
% Jech 12.10, 12.11

\item \emph{Extensionality} holds from (\ref{lemma:extensionality_in_transitive}).

\item \emph{Foundation} holds from (\ref{lemma:foundation_in_transitive}).

\item \emph{Union}:\\ % TODO kontrola % separatni lemma, ze plati v kazdem V_\alpha?
% (see (\ref{def:union}))
%\begin{equation}
%\forall x \exists y \forall z (z \in y \iff \exists q( z \in q \et q \in x))
%\end{equation}
Given any $x \in V_\lambda$, we want verify that $y = \bigcup x$ is also in $V_\lambda$. Note that $y = \bigcup x$ is a $\Delta_0$-formula.
\beq
y = \bigcup x \iff (\forall z \in y)(\exists q \in x) z \in q \et (\forall z \in x)(\forall q \in z) q \in y
\eeq
So by lemma (\ref{lemma:delta_0_absoluteness})
\beq
% y = \bigcup x \iff (y = \bigcup x)^{V_\lambda}
y = \bigcup x \iff V_\lambda \models y = \bigcup x
\eeq
% asi ok ^

\item \emph{Pairing}: \\ % TODO kontrola
% (see (\ref{def:pairing}))
%\beq
%\forall x, y \exists z \forall q (q \in z \iff q = x \lor q = y)
%\eeq
Given two sets $x, y \in V_\lambda$, we want to show that $z = \{x, y\}$ is also an element of $V_\lambda$.
\beq
z = \{x, y\} \iff x \in z \et y \in z \et (\forall q \in z)(q = x \lor q = y)
\eeq
So $z = \{x, y\}$ is a $\Delta_0$-formula, and thus by lemma (\ref{lemma:delta_0_absoluteness}) it holds that
\beq
%z = \{x, y\} \iff (z = \{x, y\})^{V_\lambda}
z = \{x, y\} \iff V_\lambda \models z = \{x, y\}
\eeq
% asi ok ^


\item \emph{Powerset}: \\
%\begin{equation}
%\forall x \exists y \forall z (z \subseteq x \iff z \in y)
%\end{equation}
Given any $x \in V_\lambda$, we want to make sure that $\power{x} \in V_\lambda$. Let $\varphi(y)$ denote the formula $y \in \power{x} \iff y \subset x$.
according to definition of subset (\ref{def:subset}), $y \subset x$ is $\Delta_0$, so for any given $x, y \in V_\lambda$, $y = \power{x} \iff V_\lambda \models y = \power{x}$.
Because $\lambda$ is limit and $rank(\power{x}) = rank(x)+1$, if $\power{x} \in V_\lambda$ for every $x \in V_\lambda$.
% cajk

\item \emph{Specification}: \\ %zkontrolovat, podle Draka, pripadne Jech 12.11
Given a first-order formula $\varphi$, we want to show the following:
\beq
V_\lambda \models \forall x, p_1, \ldots, p_n, \exists y \forall z (z \in y \iff z \in x \et \varphi(z, p_1, \ldots, p_n))
\eeq
Given any $x$ along with parameters $p_1, \ldots, p_n$ in $V_\lambda$, we set
\beq
y~=~\{z~\in~x~:~\varphi^{V_\lambda}(z, p_1, \ldots, p_n)\}
\eeq
From transitivity of $V_\lambda$ and the fact that $y \subset x$ and $x \in V_\lambda$, we know that $y \in V_\lambda$, 
so $V_\lambda \models \forall z (z \in y \iff z \in x \et \varphi(z, p_1, \dots, p_n))$.
\ece
\end{proof}

% The lemma we've just proven shows how important are the axioms of \emph{Infinity} and \emph{Replacement} for \sf{ZFC}. If we only add \emph{Infinity}, we don't get above $V_{\omega+\omega}$\footnote{TODO citation needed!}, so replacements if needed to 

%TODO citace! http://ozark.hendrix.edu/~yorgey/settheory/13-SI.pdf
% http://ozark.hendrix.edu/~yorgey/settheory/12-relative-consistency-2.pdf 
% -- jako konzistence ZF-reg -- ukazeme ze V jakozto sjednoveni V_alpha je model?

% TODO v kanamorim? co dukaz?
%\begin{definition}{(First-Order Reflection Schema)}\\ % wtf, pro jedu nebo kolik formuli?
%Let $\varphi_1, \ldots, \varphi_n$ be first-order formulas in the language of set theory.
%For each set $M_0$ there is such set $M$ that $M_0 \subset M$ and the following holds for every $i$, $1 \leq i \leq n$:
%\begin{equation}\label{equation:refl_lemma_i}
%\exists x \varphi_i(p_1, \ldots, p_{m-1}, x) \then (\exists x \in M) \varphi_i(p_1, \ldots, p_{m-1}, x)
%\end{equation}
%for every $p_1, \ldots, p_{m-1} \in M$.
%\end{definition}
% elegantnejsi by bylo formulovat to pro jednu formuli a pak ukazat, ze se to totez.

\begin{definition}{(First-Order Reflection Schema)}\label{def:first_order_reflection}\\ % Jednu
%Let $\varphi$ be a first-order formula in the language of set theory.
% and a set $M_0$ there is such set $M$ that $M_0 \subseteq M$ and the following holds for every $p_1, \ldots, p_n \in M$:
For every first-order formula $\varphi$, the following is an axiom:
\begin{equation}
\forall M_0 \exists M (M_0 \subseteq M \et (\varphi(p_1, \ldots, p_n) \iff \varphi(p_1, \ldots, p_n)^M)) % drive \langle M, \in \rangle \models \varphi, ale to vypada divne
\end{equation}
We will refer to this axiom schema as \emph{First-order reflection}.
\end{definition}

% TODO staci vzit uzaver obou fli a udelat konjunkci

% pozor na to, ze jsme dokazali zdanlive silnejsi tvrzeni pro n formuli a ted predpokladame jenom jednu.
% zkontroluj ze to tak je a napis ze silnejsi vysledek a slabsi predpoklad jsou cool, jsou ve skutecnostni ekvivalentni

Let \emph{Infinity} and \emph{Replacement} be as defined in (\ref{def:infinity}) and (\ref{def:replacement}) respectively.

\begin{theorem}\label{theorem:levy_equivalence_contemporary}
\emph{First-order reflection} is equivalent to \emph{Infinity} $ \et $ \emph{Replacement} under $\sf{S}$.
\end{theorem}
% lemma:model_of_s?
\begin{proof}
Since (\ref{theorem:first_order_reflection}) already gives us one side of the implication, we are only interested in showing the converse which we shall do in two parts:

$\bold{\emph{First-order reflection} \then \emph{Infinity}}$
This is done exactly like (\ref{theorem:n0_implies_infinity}). We pick for $\varphi$ the formula $(\forall y \in x)(y \cup \{y\} \in x)$, $M_0 = \{\emptyset\}$. From (\ref{def:first_order_reflection}), there is a set $M$ that satisfies $\varphi$, so there is an inductive set. We have picked $M_0$ so that $\emptyset \in M$ obviously holds and $M$ is the witness for 
\beq
\exists x(\emptyset \in x \et (\forall y \in x)(y \cup \{y\} \in x))
\eeq
which is exactly (\ref{def:infinity}).

\

$\bold{\emph{First-order reflection} \then \emph{Replacement}}$

%Given a~formula $\varphi(x, y, p_1, \ldots, p_n)$, we can suppose that if it holds for given $x, y, p_1, \ldots, p_n$, it is reflected in a set $M$ \footnote{Which means that for $x, y, p_1, \ldots, p_n \in M$, $\varphi^M(x, y, p_1, \ldots, p_n) \iff \varphi(x, y, p_1, \ldots, p_n)$.}
%What we want to obtain is the following:
%\begin{equation}
%\begin{gathered}
%\forall x, y, z (\varphi(x, y, p_1, \ldots, p_n) \et \varphi(x, z, p_1, \ldots, p_n) \then y = z) \then\\
%\then \forall X \exists Y \forall y\ (y \in Y \iff \exists x (\varphi(x, y, p_1, \ldots, p_n) \et x \in X ))
%\end{gathered}
%\end{equation}

%TODO OMG FIX! Drake nebo jech nebo Kanamori!
Let's first point out that while \emph{First-order reflection} gives us a set for one formula, we can generalize it to hold for any finite number of formulas. We will show how is it done for two formulas, which is what we will use in this proof. Given two first-order formulas $\varphi, \psi$, we can suppose that there are formulas $\varphi'$ and $\psi'$ that are equivalent to $\varphi$ and $\psi$ respectively, but their free variables are different \footnote{This is plausible since we can for example substitute all free variables in $\varphi'$ for $x_0, x_2, x_4, \ldots$ and use $x_1, x_3, x_5, \ldots$ for free variables in $\psi'$, the resulting formulas will be equivalent.}. Let $\xi = \varphi \et \psi$, given any $M_0$, we can find a $M$ such that $\xi \iff \xi^M$. It is easy to see that from relativisation, the following holds:
\beq
\varphi \et \psi \iff \varphi' \et \psi' \iff \xi \iff \xi^M \iff (\varphi' \et \psi')^M \iff \varphi'^M \et \psi'^M \iff \varphi^M \et \psi^M
\eeq

Now given a function $\varphi(x, y)$, we know from \emph{First-order reflection} that for every $M_0$, there is a set $M$ such that $M_0 \subseteq M$ and both
\beq
(\forall x,y \in M)(\varphi(x, y) \iff \varphi^M(x, y))
\eeq 
and
\beq
(\forall x, y \in M)(\exists y \varphi(x, y) \iff (\exists y \varphi(x, y))^M)
\eeq 
hold, the latter being equivalent to 
\beq
(\forall x, y \in M)(\exists y \varphi(x, y) \iff (\exists y \in M) \varphi^M(x, y))
\eeq
Therefore 
\beq
(\forall x, y \in M)(\exists y \varphi(x, y) \iff (\exists y \in M) \varphi(x, y))
\eeq
holds too.
That means that we have a set $M$ such that for every $x \in M$, if $\varphi$ is defined for $x$, $(\exists y \in M) \varphi(x, y)$. 

To show that \emph{Replacement} holds for this particular $\varphi$, we need to verify that given a set $M_0$, $M'_0 = \{ y : (\exists x \in M_0) \varphi(x, y)\}$ is also a set. But since $M_0 \subseteq M$ and because given any $x \in M$, there is $y \in M$ satisfying $\varphi(x, y)$, the following is a set due to \emph{Specification}:
\beq
M'_0 = \{ y : (\exists x \in M_0) \varphi(x, y)\} = \{ y \in M : (\exists x \in M_0) \varphi(x, y)\}
\eeq
% tranzitivita? V_\lambda?

%We also know that $x, y \in M$, in other words for every $X$, $Y = \{y : \varphi(x, y, p_1, \ldots, p_n)\}$ and we know that $X \subset M$ and $Y \subset M$, which, together with the specification schema implies that $Y$, the image of $X$ over $\varphi$, is a~set.
\end{proof}

\

% Stronger reflection: 
% a: any number of formulas
% b: there is a club set of $M$s.
% asi do dalsi kapitoly

% co s tema $\emph{Reflection}$ / reflection / Reflection ??
We have shown that $\emph{Reflection}$ for first-order formulas, \emph{First-order reflection} is a~theorem of $\sf{ZFC}$.%, which means that it won't yield us any large cardinals. 
We have also shown that it can be used instead of the \emph{Infinity} and \emph{Replacement} scheme, but $\sf{ZFC}\ +\ \emph{First-order reflection}$ is a~conservative extension of $\sf{ZF}$. Besides being a~starting point for more general and powerful statements, it can be used to show that $\sf{ZF}$ is not finitely axiomatizable. This follows from the fact that \emph{Reflection} gives a~model to any consistent finite set of formulas. % or their conjunction? % nedokazal jsem verzi pro n formuli!
So if $\varphi_1, \ldots, \varphi_n$ would be the axioms of $\sf{ZFC}$, $\emph{Reflection}$ would prove that every model of $\sf{ZFC}$ contains a smaller model of $\sf{ZFC}$, which would in turn contradict the Second Gödel's Theorem\footnote{See chapter \ref{section:inaccessibility} for further details.}.

It is also worthwhile to note that, in a~way, Reflection is dual to compactness. 
% ref http://www.helsinki.fi/sls2015/materials/Fontanella%20Scandinavian%20Summer%20School.pdf
Compactness says that given a set of sentences, if every finite subset yields a~model, so does the whole set. Reflection, on the other hand, says that while the whole set has no model in the underlying theory, every finite subset has a model.

Furthemore, $\emph{Reflection}$ can be used in ways similar to upward Löwenheim–Skolem theorem.
Since Reflection extends any set $M_0$ into a~model of given formulas $\varphi_1, \ldots, \varphi_n$, we can choose the lower bound of the size of $M$ by appropriately choosing $M_0$.

In the next section, we will try to generalize \emph{Reflection} in a~way that transcends $\sf{ZF}$ and yields some large cardinals.
\newpage
% =============================================================
